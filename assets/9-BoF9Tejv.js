import{u as l,j as s}from"./index-CkPAr150.js";import{P as m,a as r}from"./_components-CwXKVufl.js";const a={tags:["Memoization"],description:"Advent of Code 2020 - Day 9: Encoding Error, a problem that involves Memoization. Solution written in Python, with detailed walkthrough and proof.",year:2020,day:9,title:"Advent of Code 2020 - Day 9: Encoding Error"};function i(n){const e={annotation:"annotation",code:"code",h1:"h1",h2:"h2",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",...l(),...n.components};return s.jsxs(s.Fragment,{children:[s.jsxs(e.h1,{children:["Advent of Code 2020 - Day 9",s.jsx(e.span,{className:"subtitle",children:"Encoding Error"})]}),`
`,`
`,s.jsx(m,{frontMatter:a}),`
`,s.jsx(e.h2,{children:"Part 1"}),`
`,s.jsx(e.p,{children:"The naïve solution doesn't work very badly here, since the preamble is only 25 numbers long. For each number after the preamble, we compute the pairwise sums of the previous 25 numbers and see if any of them equal the current number."}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-python",children:`if nums[i] not in sums:
    return nums[i]
sums = set(
    map(sum, itertools.combinations(nums[i - preamble_len + 1 : i + 1], 2))
)
`})}),`
`,s.jsxs(e.p,{children:["Every time, it only computes ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mo,{fence:"true",children:"("}),s.jsxs(e.mfrac,{linethickness:"0px",children:[s.jsx(e.mn,{children:"25"}),s.jsx(e.mn,{children:"2"})]}),s.jsx(e.mo,{fence:"true",children:")"})]}),s.jsx(e.mo,{children:"="}),s.jsx(e.mn,{children:"300"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\binom{25}{2} = 300"})]})})}),s.jsxs(e.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1.2451em",verticalAlign:"-0.35em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:s.jsx(e.span,{className:"delimsizing size1",children:"("})}),s.jsx(e.span,{className:"mfrac",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"0.8951em"},children:[s.jsxs(e.span,{style:{top:"-2.355em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:s.jsx(e.span,{className:"mord mtight",children:"2"})})})]}),s.jsxs(e.span,{style:{top:"-3.144em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:s.jsx(e.span,{className:"mord mtight",children:"25"})})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.345em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:s.jsx(e.span,{className:"delimsizing size1",children:")"})})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.6444em"}}),s.jsx(e.span,{className:"mord",children:"300"})]})]})]})," sums to check, which is fast enough. The following optimization attempt does not work:"]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-python",children:`sums = sums.difference(
    {nums[i - preamble_len] + x for x in nums[i - preamble_len + 1 : i]}
).union({nums[i] + x for x in nums[i - preamble_len + 1 : i]})
`})}),`
`,s.jsxs(e.p,{children:["The idea here, is if we are removing ",s.jsx(e.code,{children:"nums[i - preamble_len]"})," from the preamble and adding ",s.jsx(e.code,{children:"nums[i]"}),", we invalidate ",s.jsx(e.code,{children:"nums[i - preamble_len] + nums[j]"})," for ",s.jsx(e.code,{children:"j"})," in ",s.jsx(e.code,{children:"[i - preamble_len + 1, i)"}),", and we need to add ",s.jsx(e.code,{children:"nums[i] + nums[j]"})," for the same ",s.jsx(e.code,{children:"j"})," range. However, this doesn't work because some sums may be duplicated; we may remove a sum that was formed by two different pairs, and only one of those pairs is invalidated."]}),`
`,s.jsxs(e.p,{children:["However, we can still do this, just by replacing the ",s.jsx(e.code,{children:"set"})," with a ",s.jsx(e.code,{children:"collections.Counter"}),", which tracks how many times each sum appears. Then, when we remove sums, we decrement their counts, and only delete them from the ",s.jsx(e.code,{children:"Counter"})," when their count reaches zero."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-python",children:`for j in range(i - preamble_len + 1, i):
    pair_sum = nums[i - preamble_len] + nums[j]
    sums[pair_sum] -= 1
    pair_sum = nums[i] + nums[j]
    sums[pair_sum] += 1
`})}),`
`,s.jsxs(e.p,{children:["Now updating ",s.jsx(e.code,{children:"sums"})," is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"script",children:"O"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"k"}),s.jsx(e.mo,{stretchy:"false",children:")"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(k)"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),s.jsx(e.span,{className:"mclose",children:")"})]})})]})," instead of ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"script",children:"O"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsxs(e.msup,{children:[s.jsx(e.mi,{children:"k"}),s.jsx(e.mn,{children:"2"})]}),s.jsx(e.mo,{stretchy:"false",children:")"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(k^2)"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),s.jsx(e.span,{className:"msupsub",children:s.jsx(e.span,{className:"vlist-t",children:s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.8141em"},children:s.jsxs(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),s.jsx(e.span,{className:"mclose",children:")"})]})})]}),", where ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsx(e.mi,{children:"k"})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"k"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.6944em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]})," is the preamble length."]}),`
`,s.jsx(e.h2,{children:"Part 2"}),`
`,s.jsxs(e.p,{children:["The idea is somewhat similar to part 1. Instead of enumerating all contiguous subarrays and checking their sums, we can use a two-pointer approach to find a subarray that sums to the target value. Namely, we have ",s.jsx(e.code,{children:"sum(nums[i:j]) == sum(nums[0:j]) - sum(nums[0:i])"}),", so we just need an array of prefix sums where ",s.jsx(e.code,{children:"running_sums[i] == sum(nums[0:i])"}),". Then, ",s.jsx(e.code,{children:"invalid == running_sum[j] - running_sum[i-1]"})," => ",s.jsx(e.code,{children:"running_sum[j] - invalid == running_sum[i-1]"}),". We can just intersect ",s.jsx(e.code,{children:"running_sums"})," with ",s.jsx(e.code,{children:"running_sums - invalid"})," to find matching pairs, which would be the value for ",s.jsx(e.code,{children:"running_sum[i-1]"}),". There will be two results: one corresponds to ",s.jsx(e.code,{children:"running_sum[i-1]"})," and the other corresponds to ",s.jsx(e.code,{children:"running_sum[index_invalid - 1]"})," (since ",s.jsx(e.code,{children:"running_sum[index_invalid] - running_sum[index_invalid - 1] == invalid"}),"); we take the smaller one. NumPy makes everything simple."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-python",children:`running_sum = np.cumsum(nums)
sum_i_p_1 = min(set(running_sum - invalid).intersection(set(running_sum)))
i = np.where(running_sum == sum_i_p_1)[0][0] + 1
j = np.where(running_sum == sum_i_p_1 + invalid)[0][0]
num_range = nums[i : j + 1]
`})}),`
`,s.jsxs(e.p,{children:["Note that enumerating all ",s.jsx(e.code,{children:"(i, j)"})," pairs would also work, but that is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"script",children:"O"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsxs(e.msup,{children:[s.jsx(e.mi,{children:"n"}),s.jsx(e.mn,{children:"2"})]}),s.jsx(e.mo,{stretchy:"false",children:")"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(n^2)"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"n"}),s.jsx(e.span,{className:"msupsub",children:s.jsx(e.span,{className:"vlist-t",children:s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.8141em"},children:s.jsxs(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),s.jsx(e.span,{className:"mclose",children:")"})]})})]}),". The solution here is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"script",children:"O"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mi,{children:"log"}),s.jsx(e.mo,{children:"⁡"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mo,{stretchy:"false",children:")"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(n\\log n)"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"n"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsxs(e.span,{className:"mop",children:["lo",s.jsx(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"n"}),s.jsx(e.span,{className:"mclose",children:")"})]})})]}),", assuming set membership and insertion is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"script",children:"O"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"log"}),s.jsx(e.mo,{children:"⁡"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mo,{stretchy:"false",children:")"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(\\log n)"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsxs(e.span,{className:"mop",children:["lo",s.jsx(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"n"}),s.jsx(e.span,{className:"mclose",children:")"})]})})]}),"."]}),`
`,s.jsx(r,{frontMatter:a})]})}function h(n={}){const{wrapper:e}={...l(),...n.components};return e?s.jsx(e,{...n,children:s.jsx(i,{...n})}):i(n)}export{h as default,a as frontMatter};
