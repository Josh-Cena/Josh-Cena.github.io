import{u as i,j as s}from"./index-BbGgi_W7.js";import{P as l,a as m}from"./_components-B9H8t5ur.js";import"./_commonjsHelpers-Cpj98o6Y.js";const n={tags:["Arcade game","Period finding"],title:"Advent of Code 2023 - Day 14: Parabolic Reflector Dish",description:"Advent of Code 2023 - Day 14: Parabolic Reflector Dish, a problem that involves Arcade game and Period finding. Solution written in R, with detailed walkthrough and proof.",year:2023,day:14};function t(a){const e={annotation:"annotation",code:"code",h1:"h1",h2:"h2",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",p:"p",pre:"pre",semantics:"semantics",span:"span",...i(),...a.components};return s.jsxs(s.Fragment,{children:[s.jsxs(e.h1,{children:["Advent of Code 2023 - Day 14",s.jsx(e.span,{className:"subtitle",children:"Parabolic Reflector Dish"})]}),`
`,`
`,s.jsx(l,{frontMatter:n}),`
`,s.jsx(e.h2,{children:"Part 1"}),`
`,s.jsxs(e.p,{children:["The implementation of ",s.jsx(e.code,{children:"tilt"}),' is straightforward: we iterate each column from the "bottom" (the bottom is defined by the tilting direction; for example a north tilt means we iterate from the first row to the last row, while a east tilt means we iterate from the last column to the first column). We keep two pointers: ',s.jsx(e.code,{children:"expected_pos"})," is the position where the next ",s.jsx(e.code,{children:"O"})," should go, and ",s.jsx(e.code,{children:"j"})," is the current position. If we see an ",s.jsx(e.code,{children:"O"}),", we move it to ",s.jsx(e.code,{children:"expected_pos"})," and update ",s.jsx(e.code,{children:"expected_pos"}),". If we see a ",s.jsx(e.code,{children:"#"}),", we update ",s.jsx(e.code,{children:"expected_pos"})," to be the next position after the wall."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-R",children:`tilt <- function(mat, dir) {
  m <- if (dir %in% c("N", "S")) nrow(mat) else ncol(mat)
  n <- if (dir %in% c("N", "S")) ncol(mat) else nrow(mat)
  for (i in seq_len(m)) {
    expected_pos <- if (dir %in% c("N", "W")) 1 else n
    for (j in if (dir %in% c("N", "W")) seq_len(n) else rev(seq_len(n))) {
      cur_ch <- if (dir %in% c("N", "S")) mat[j, i] else mat[i, j]
      if (cur_ch == "O") {
        if (dir %in% c("N", "S")) {
          mat[j, i] <- "."
          mat[expected_pos, i] <- "O"
        } else {
          mat[i, j] <- "."
          mat[i, expected_pos] <- "O"
        }
        expected_pos <- expected_pos + if (dir %in% c("N", "W")) 1 else -1
      } else if (cur_ch == "#") {
        expected_pos <- j + if (dir %in% c("N", "W")) 1 else -1
      }
    }
  }
  mat
}
`})}),`
`,s.jsx(e.h2,{children:"Part 2"}),`
`,s.jsxs(e.p,{children:["Again, R has given me more headaches than it spares me ðŸ˜… Obviously, we want to find the period for the tilting cycles, which involves tracking the list of seen configurations, but R does not have hashing for matrices. I used the classic ",s.jsx(e.code,{children:"new.env()"})," hack, which gives me a string map, but its keys can be at most 10,000 bytes long, and the matrix has exactly 10,000 elements, so I can't just naÃ¯vely stringify it as a key. Instead, I had to compress the matrix to 2 bits per cell (since there are only 3 states) and serialize it as base64. Anyway, all of this is really tedious and nothing remarkable."]}),`
`,s.jsxs(e.p,{children:["Once I have a hashmap implementation, the rest is standard period finding. If I see the same configuration twice, once at ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"0"})]})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"t_0"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"0"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]})]})})]})," and once at ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"1"})]})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"t_1"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"1"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]})]})})]}),", then the period is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"1"})]}),s.jsx(e.mo,{children:"âˆ’"}),s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"0"})]})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"t_1 - t_0"})]})})}),s.jsxs(e.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"1"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"âˆ’"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"0"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]})]})]})]}),", and the configuration at ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsx(e.mi,{children:"T"})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"T"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})]})})]})," is the same as ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"T"}),s.jsx(e.mo,{children:"âˆ’"}),s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"0"})]}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mtext,{children:"â€Š"}),s.jsx(e.mo,{lspace:"0.22em",rspace:"0.22em",children:s.jsxs(e.mrow,{children:[s.jsx(e.mi,{mathvariant:"normal",children:"m"}),s.jsx(e.mi,{mathvariant:"normal",children:"o"}),s.jsx(e.mi,{mathvariant:"normal",children:"d"})]})}),s.jsx(e.mtext,{children:"â€Š"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"1"})]}),s.jsx(e.mo,{children:"âˆ’"}),s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"0"})]}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mo,{children:"+"}),s.jsxs(e.msub,{children:[s.jsx(e.mi,{children:"t"}),s.jsx(e.mn,{children:"0"})]})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"(T - t_0) \\bmod (t_1 - t_0) + t_0"})]})})}),s.jsxs(e.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"âˆ’"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"0"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]}),s.jsx(e.span,{className:"mclose",children:")"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.0556em"}}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathrm",children:"mod"})})}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.0556em"}}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"1"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"âˆ’"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"0"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]}),s.jsx(e.span,{className:"mclose",children:")"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"+"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"t"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.3011em"},children:s.jsxs(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(e.span,{className:"mord mtight",children:"0"})})]})}),s.jsx(e.span,{className:"vlist-s",children:"â€‹"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(e.span,{})})})]})})]})]})]})]}),". The time starts at ",s.jsx(e.code,{children:"0"}),", but again because in R the first index is ",s.jsx(e.code,{children:"1"}),", I had to add ",s.jsx(e.code,{children:"1"})," when indexing into ",s.jsx(e.code,{children:"loads"}),"."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-R",children:`seen <- new.env()
its <- 0
loads <- list()
repeat {
  key <- serialize_matrix(mat)
  if (!is.null(seen[[key]])) {
    last_it <- seen[[key]]
    period <- its - last_it
    break
  }
  loads[[its + 1]] <- load(mat)
  seen[[key]] <- its
  mat <- tilt(mat, "N")
  mat <- tilt(mat, "W")
  mat <- tilt(mat, "S")
  mat <- tilt(mat, "E")
  its <- its + 1
}
ending_pos <- (1000000000 - last_it) %% period + last_it
cat(loads[[ending_pos + 1]], "\\n")
`})}),`
`,s.jsx(m,{frontMatter:n})]})}function d(a={}){const{wrapper:e}={...i(),...a.components};return e?s.jsx(e,{...a,children:s.jsx(t,{...a})}):t(a)}export{d as default,n as frontMatter};
