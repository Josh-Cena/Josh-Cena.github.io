import{u as l,j as s}from"./index-L6ckUcGi.js";import{F as i,a as m}from"./_components-DB3Df8DK.js";const n={tags:["Data structures","Geometry"],description:"Advent of Code 2021 - Day 22: Reactor Reboot, a problem that involves Data structures and Geometry. Solution written in TypeScript, with detailed walkthrough and proof.",year:2021,day:22,title:"Advent of Code 2021 - Day 22: Reactor Reboot"};function t(e){const a={annotation:"annotation",code:"code",h1:"h1",math:"math",mi:"mi",mo:"mo",mrow:"mrow",mstyle:"mstyle",msub:"msub",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",p:"p",pre:"pre",semantics:"semantics",span:"span",...l(),...e.components};return s.jsxs(s.Fragment,{children:[s.jsxs(a.h1,{children:["Advent of Code 2021 - Day 22",s.jsx(a.span,{className:"subtitle",children:"Reactor Reboot"})]}),`
`,`
`,s.jsx(i,{frontMatter:n}),`
`,s.jsx(a.p,{children:`Essentially, the question asks us to maintain a data structure containing "on" cuboids in 3D space, supporting addition and subtraction of cuboids. Part 1's constraints allow for a simple solution using a 3D array of voxels, but that won't scale to part 2.`}),`
`,s.jsx(a.p,{children:'The most natural way of thinking is to have a list of non-overlapping "on" cuboids. The problem is that, for example, if we have a cuboid from (0, 0, 0) to (3, 3, 3), and we subtract a cuboid from (1, 1, 1) to (2, 2, 2), we end up with up to 6 new cuboids, one for each face of the hollow cuboid. Implementing this correctly is quite intractable.'}),`
`,s.jsxs(a.p,{children:[`Instead, my data structure contains both "on" and "off" cuboids. For each voxel, it's guaranteed that `,s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsxs(a.mrow,{children:[s.jsxs(a.msub,{children:[s.jsx(a.mi,{children:"n"}),s.jsx(a.mtext,{children:"on"})]}),s.jsx(a.mo,{children:"−"}),s.jsxs(a.msub,{children:[s.jsx(a.mi,{children:"n"}),s.jsx(a.mtext,{children:"off"})]})]}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"n_\\text{on} - n_\\text{off}"})]})})}),s.jsxs(a.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.7333em",verticalAlign:"-0.15em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"n"}),s.jsx(a.span,{className:"msupsub",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsx(a.span,{className:"vlist",style:{height:"0.1514em"},children:s.jsxs(a.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(a.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(a.span,{className:"mord text mtight",children:s.jsx(a.span,{className:"mord mtight",children:"on"})})})]})}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(a.span,{})})})]})})]}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"−"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"n"}),s.jsx(a.span,{className:"msupsub",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsx(a.span,{className:"vlist",style:{height:"0.3361em"},children:s.jsxs(a.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(a.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(a.span,{className:"mord text mtight",children:s.jsx(a.span,{className:"mord mtight",children:"off"})})})]})}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(a.span,{})})})]})})]})]})]})]})," is either 0 or 1, where ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsxs(a.msub,{children:[s.jsx(a.mi,{children:"n"}),s.jsx(a.mtext,{children:"on"})]})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"n_\\text{on}"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"n"}),s.jsx(a.span,{className:"msupsub",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsx(a.span,{className:"vlist",style:{height:"0.1514em"},children:s.jsxs(a.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(a.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(a.span,{className:"mord text mtight",children:s.jsx(a.span,{className:"mord mtight",children:"on"})})})]})}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(a.span,{})})})]})})]})]})})]}),' is the number of "on" cuboids containing that voxel, and ',s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsxs(a.msub,{children:[s.jsx(a.mi,{children:"n"}),s.jsx(a.mtext,{children:"off"})]})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"n_\\text{off}"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"n"}),s.jsx(a.span,{className:"msupsub",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsx(a.span,{className:"vlist",style:{height:"0.3361em"},children:s.jsxs(a.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(a.span,{className:"sizing reset-size6 size3 mtight",children:s.jsx(a.span,{className:"mord text mtight",children:s.jsx(a.span,{className:"mord mtight",children:"off"})})})]})}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"0.15em"},children:s.jsx(a.span,{})})})]})})]})]})})]}),' is the number of "off" cuboids containing that voxel. This way, the scenario above simply adds the "off" cuboid to the list. The total volume of "on" voxels can be computed by summing the volumes of all "on" cuboids and subtracting the volumes of all "off" cuboids.']}),`
`,s.jsx(a.p,{children:"Now we need to figure out how to maintain this invariant when adding and subtracting cuboids. Note that:"}),`
`,s.jsx(a.span,{className:"katex-display",children:s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:s.jsxs(a.semantics,{children:[s.jsxs(a.mtable,{rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em",children:[s.jsxs(a.mtr,{children:[s.jsx(a.mtd,{children:s.jsx(a.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(a.mrow,{children:[s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"∪"}),s.jsx(a.mi,{children:"B"})]})})}),s.jsx(a.mtd,{children:s.jsx(a.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(a.mrow,{children:[s.jsx(a.mrow,{}),s.jsx(a.mo,{children:"="}),s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"+"}),s.jsx(a.mi,{children:"B"}),s.jsx(a.mo,{children:"−"}),s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"∩"}),s.jsx(a.mi,{children:"B"})]})})})]}),s.jsxs(a.mtr,{children:[s.jsx(a.mtd,{children:s.jsx(a.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(a.mrow,{children:[s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"∖"}),s.jsx(a.mi,{children:"B"})]})})}),s.jsx(a.mtd,{children:s.jsx(a.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(a.mrow,{children:[s.jsx(a.mrow,{}),s.jsx(a.mo,{children:"="}),s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"−"}),s.jsx(a.mi,{children:"A"}),s.jsx(a.mo,{children:"∩"}),s.jsx(a.mi,{children:"B"})]})})})]})]}),s.jsx(a.annotation,{encoding:"application/x-tex",children:`\\begin{align*}
A\\cup B &= A + B - A\\cap B \\\\
A\\setminus B &= A - A\\cap B
\\end{align*}`})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),s.jsx(a.span,{className:"mord",children:s.jsxs(a.span,{className:"mtable",children:[s.jsx(a.span,{className:"col-align-r",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsxs(a.span,{className:"vlist",style:{height:"1.75em"},children:[s.jsxs(a.span,{style:{top:"-3.91em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"3em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∪"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})]}),s.jsxs(a.span,{style:{top:"-2.41em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"3em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∖"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})]})]}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"1.25em"},children:s.jsx(a.span,{})})})]})}),s.jsx(a.span,{className:"col-align-l",children:s.jsxs(a.span,{className:"vlist-t vlist-t2",children:[s.jsxs(a.span,{className:"vlist-r",children:[s.jsxs(a.span,{className:"vlist",style:{height:"1.75em"},children:[s.jsxs(a.span,{style:{top:"-3.91em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"3em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(a.span,{className:"mrel",children:"="}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"+"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"−"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∩"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})]}),s.jsxs(a.span,{style:{top:"-2.41em"},children:[s.jsx(a.span,{className:"pstrut",style:{height:"3em"}}),s.jsxs(a.span,{className:"mord",children:[s.jsx(a.span,{className:"mord"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(a.span,{className:"mrel",children:"="}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"−"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",children:"A"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∩"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})]})]}),s.jsx(a.span,{className:"vlist-s",children:"​"})]}),s.jsx(a.span,{className:"vlist-r",children:s.jsx(a.span,{className:"vlist",style:{height:"1.25em"},children:s.jsx(a.span,{})})})]})})]})})]})})]})}),`
`,s.jsxs(a.p,{children:["where ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mo,{children:"+"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"+"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),s.jsx(a.span,{className:"mord",children:"+"})]})})]})," and ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mo,{children:"−"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"-"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),s.jsx(a.span,{className:"mord",children:"−"})]})})]}),' are joining and subtraction of lists. Therefore, when adding an "on" cuboid ',s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"C"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"C"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]}),", we add ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"C"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"C"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]})," to the list, and for each existing cuboid ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"E"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})})]}),", we add ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsxs(a.mrow,{children:[s.jsx(a.mi,{children:"E"}),s.jsx(a.mo,{children:"∩"}),s.jsx(a.mi,{children:"C"})]}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E\\cap C"})]})})}),s.jsxs(a.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∩"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})]})]}),' with the opposite state (i.e., "off" if ',s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"E"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})})]}),' is "on" and vice versa). Conceptually: if we have both ',s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"E"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})})]})," and ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"C"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"C"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]}),", we have double-counted ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsxs(a.mrow,{children:[s.jsx(a.mi,{children:"E"}),s.jsx(a.mo,{children:"∩"}),s.jsx(a.mi,{children:"C"})]}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E\\cap C"})]})})}),s.jsxs(a.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∩"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})]})]}),", so we need to subtract it out; if we have ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"C"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"C"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]}),' and an existing "off" cuboid ',s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsx(a.mrow,{children:s.jsx(a.mi,{children:"E"})}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E"})]})})}),s.jsx(a.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})})]}),", then we should stop subtracting ",s.jsxs(a.span,{className:"katex",children:[s.jsx(a.span,{className:"katex-mathml",children:s.jsx(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(a.semantics,{children:[s.jsxs(a.mrow,{children:[s.jsx(a.mi,{children:"E"}),s.jsx(a.mo,{children:"∩"}),s.jsx(a.mi,{children:"C"})]}),s.jsx(a.annotation,{encoding:"application/x-tex",children:"E\\cap C"})]})})}),s.jsxs(a.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(a.span,{className:"mbin",children:"∩"}),s.jsx(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),s.jsxs(a.span,{className:"base",children:[s.jsx(a.span,{className:"strut",style:{height:"0.6833em"}}),s.jsx(a.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})]})]}),", so we need to add it back in. Subtracting a cuboid is similar, except we don't add the cuboid itself, just subtracting each intersection. Because intersections are always cuboids, this methods only ever deals with cuboids."]}),`
`,s.jsx(a.p,{children:"Here's the implementation:"}),`
`,s.jsx(a.pre,{children:s.jsx(a.code,{className:"language-ts",children:`function add(existing: Cube[], cube: Cube): Cube[] {
  const res = [...existing];
  if (cube.sign === 1) res.push(cube);
  for (const p of existing) {
    const intersection = intersectCubes(p, cube, p.sign === 1 ? -1 : 1);
    if (!intersection) continue;
    res.push(intersection);
  }
  return res;
}
`})}),`
`,s.jsx(a.p,{children:'As mentioned, the total volume of "on" voxels is the sum of the volumes of all "on" cuboids minus the sum of the volumes of all "off" cuboids:'}),`
`,s.jsx(a.pre,{children:s.jsx(a.code,{className:"language-ts",children:`let cubes: Cube[] = [];
for (const cube of cubeOps) {
  cubes = add(cubes, cube);
}
let sum = 0;
for (const cube of cubes) {
  const [x0, x1] = cube.x;
  const [y0, y1] = cube.y;
  const [z0, z1] = cube.z;
  sum += (x1 - x0 + 1) * (y1 - y0 + 1) * (z1 - z0 + 1) * cube.sign;
}
console.log(sum);
`})}),`
`,s.jsx(m,{frontMatter:n})]})}function h(e={}){const{wrapper:a}={...l(),...e.components};return a?s.jsx(a,{...e,children:s.jsx(t,{...e})}):t(e)}export{h as default,n as frontMatter};
