import{u as l,j as s}from"./index-CuM7bDfp.js";import{F as i,a as c}from"./_components-1-OWSA-J.js";const t={tags:["Memoization"],description:"Advent of Code 2024 - Day 19: Linen Layout, a problem that involves Memoization. Solution written in OCaml, with detailed walkthrough and proof.",year:2024,day:19,title:"Advent of Code 2024 - Day 19: Linen Layout"};function n(a){const e={a:"a",annotation:"annotation",code:"code",h1:"h1",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mstyle:"mstyle",msub:"msub",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",p:"p",pre:"pre",semantics:"semantics",span:"span",...l(),...a.components};return s.jsxs(s.Fragment,{children:[s.jsxs(e.h1,{children:["Advent of Code 2024 - Day 19",s.jsx(e.span,{className:"subtitle",children:"Linen Layout"})]}),`
`,`
`,s.jsx(i,{frontMatter:t}),`
`,s.jsxs(e.p,{children:["This problem pays tribute to ",s.jsx(e.a,{href:"/notes/aoc/2023/12/",children:"2023 day 12"}),"."]}),`
`,s.jsxs(e.p,{children:["Essentially we are given a list of strings and we want to use them to construct a target string. This problem is recursive in nature, because each time, we find a suitable string that is a prefix of the target string, remove it and match the rest. For example, given the target string ",s.jsx(e.code,{children:"abc"})," and the towels ",s.jsx(e.code,{children:'["a", "ab", "bc"]'}),", we can either use ",s.jsx(e.code,{children:"a"})," and then try to construct ",s.jsx(e.code,{children:"bc"}),", or we can use ",s.jsx(e.code,{children:"ab"})," and then try to construct ",s.jsx(e.code,{children:"c"}),"."]}),`
`,s.jsx(e.span,{className:"katex-display",children:s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mtext,{children:"ways"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mo,{children:"="}),s.jsxs(e.mrow,{children:[s.jsx(e.mo,{fence:"true",children:"{"}),s.jsxs(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsx(e.mn,{children:"1"})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"s"}),s.jsx(e.mo,{children:"="}),s.jsx(e.mtext,{mathvariant:"monospace",children:'""'})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsxs(e.msub,{children:[s.jsx(e.mo,{children:"∑"}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"p"}),s.jsx(e.mo,{children:"∈"}),s.jsx(e.mtext,{children:"prefixes"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mo,{children:"∩"}),s.jsx(e.mtext,{children:"towels"})]})]}),s.jsx(e.mtext,{children:"ways"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mi,{children:"p"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsx(e.mtext,{children:"otherwise"})})})]})]})]})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:`\\text{ways}(s) = \\begin{cases}
1 & s = \\texttt{""} \\\\
\\sum_{p \\in \\text{prefixes}(s)\\cap\\text{towels}} \\text{ways}(s - p) & \\text{otherwise}
\\end{cases}`})]})})}),s.jsxs(e.span,{className:"katex-html","aria-hidden":"true",children:[s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"ways"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"s"}),s.jsx(e.span,{className:"mclose",children:")"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),s.jsxs(e.span,{className:"minner",children:[s.jsx(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:s.jsx(e.span,{className:"delimsizing size4",children:"{"})}),s.jsx(e.span,{className:"mord",children:s.jsxs(e.span,{className:"mtable",children:[s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"1.7114em"},children:[s.jsxs(e.span,{style:{top:"-3.7114em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord",children:"1"})})]}),s.jsxs(e.span,{style:{top:"-2.2714em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsxs(e.span,{className:"mop",children:[s.jsx(e.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"∑"}),s.jsx(e.span,{className:"msupsub",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsx(e.span,{className:"vlist",style:{height:"0.2253em"},children:s.jsxs(e.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"2.7em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsxs(e.span,{className:"mord mtight",children:[s.jsx(e.span,{className:"mord mathnormal mtight",children:"p"}),s.jsx(e.span,{className:"mrel mtight",children:"∈"}),s.jsx(e.span,{className:"mord text mtight",children:s.jsx(e.span,{className:"mord mtight",children:"prefixes"})}),s.jsx(e.span,{className:"mopen mtight",children:"("}),s.jsx(e.span,{className:"mord mathnormal mtight",children:"s"}),s.jsx(e.span,{className:"mclose mtight",children:")"}),s.jsx(e.span,{className:"mbin mtight",children:"∩"}),s.jsx(e.span,{className:"mord text mtight",children:s.jsx(e.span,{className:"mord mtight",children:"towels"})})]})})]})}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.4747em"},children:s.jsx(e.span,{})})})]})})]}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"ways"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"s"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"p"}),s.jsx(e.span,{className:"mclose",children:")"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.2114em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"arraycolsep",style:{width:"1em"}}),s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"1.7114em"},children:[s.jsxs(e.span,{style:{top:"-3.7114em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",children:"s"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord texttt",children:'""'})})]})]}),s.jsxs(e.span,{style:{top:"-2.2714em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"otherwise"})})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.2114em"},children:s.jsx(e.span,{})})})]})})]})}),s.jsx(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-ocaml",children:`let rec ways_to_construct pattern towels =
  towels
  |> List.filter (fun towel -> String.starts_with ~prefix:towel pattern)
  |> List.map (fun towel ->
      ways_to_construct
        (String.sub pattern (String.length towel)
          (String.length pattern - String.length towel))
        towels memo)
  |> List.fold_left ( + ) 0
`})}),`
`,s.jsxs(e.p,{children:["The problem is that we may be recomputing ",s.jsx(e.code,{children:"ways"})," with the same target string multiple times. The easy way out is to memoize each input for ",s.jsx(e.code,{children:"ways"}),"."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-ocaml",children:`let rec ways_to_construct pattern towels memo =
  match Hashtbl.find_opt memo pattern with
  | Some count -> count
  | None ->
      let count =
        towels
        |> List.filter (fun towel -> String.starts_with ~prefix:towel pattern)
        |> List.map (fun towel ->
            ways_to_construct
              (String.sub pattern (String.length towel)
                 (String.length pattern - String.length towel))
              towels memo)
        |> List.fold_left ( + ) 0
      in
      Hashtbl.add memo pattern count;
      count
`})}),`
`,s.jsxs(e.p,{children:["Now part 1 is the count of ",s.jsx(e.code,{children:"ways_to_construct > 0"}),", and part 2 is the sum of ",s.jsx(e.code,{children:"ways_to_construct"}),"."]}),`
`,s.jsx(c,{frontMatter:t})]})}function h(a={}){const{wrapper:e}={...l(),...a.components};return e?s.jsx(e,{...a,children:s.jsx(n,{...a})}):n(a)}export{h as default,t as frontMatter};
