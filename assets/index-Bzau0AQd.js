import{r as a,j as e}from"./index-viUjO3pU.js";import"./_commonjsHelpers-Cpj98o6Y.js";const oe="_addBuffBtn_185wl_1",ge="_equationLine_185wl_5",fe="_stackedEquationsContainer_185wl_12",pe="_stackedEquations_185wl_12",be="_leftBracket_185wl_23",me="_rightBracket_185wl_24",g={addBuffBtn:oe,equationLine:ge,stackedEquationsContainer:fe,stackedEquations:pe,leftBracket:be,rightBracket:me},D={物理:2,火:2,风:1.5,冰:1,雷:1,量子:.5,虚数:.5},ye={角色:[["百分比生命","行迹",10],["暴击伤害","天赋+四魂",68.4*5],["暴击伤害","行迹",37.3],["暴击伤害","光锥",20],["暴击伤害","一魂",36],["增伤","光锥",42],["减防","光锥",12],["减抗","六魂",30]],遗器:[["固定生命","头部",705],["固定攻击","手部",352],["百分比生命","衣服+绳子+10副词条",43.2*2.5],["暴击伤害","10副词条",64.8],["增伤","球",38.4],["增伤","学者套+行迹大招增伤",40]],辅助1:[["增伤","战技一回合",72/2],["增伤","行迹",10],["增伤","日专",45],["暴击伤害","大招覆盖率1/3",18.4]],辅助2:[["易伤","大招",30],["减抗","战技",24],["真伤","一魂",24]],辅助3:[["固定生命","大招",600],["百分比生命","大招",30],["百分比生命","一魂",50],["易伤","光锥",18]]},U=["百分比攻击","百分比生命","百分比防御","固定攻击","固定生命","固定防御","增伤","暴击伤害","击破特攻","击破增伤","易伤","减防","减抗","真伤","独立乘区"],i=r=>{const c=eval?.(r);if(typeof c!="number")throw new TypeError("Result must be number");return c};function ve(r){const c=Object.fromEntries(U.map(d=>[d,0]));for(const d of Object.values(r))for(const[m,,u]of d)c[m]+=u;return c}function S({children:r}){return e.jsxs("div",{className:g.stackedEquationsContainer,children:[e.jsx("div",{className:g.leftBracket}),e.jsx("div",{className:g.stackedEquations,children:r}),e.jsx("div",{className:g.rightBracket})]})}function s({stat:r,label:c,percentage:d}){return e.jsxs("ruby",{children:[Math.round(r*100)/100,e.jsx("rt",{children:c}),d?"%":null]})}function k({id:r,buffs:c,setBuffs:d}){const[m,u]=a.useState(!1),y=a.useRef(null),o=a.useRef(null),v=a.useRef(null);return e.jsxs("div",{children:[e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"属性"}),e.jsx("th",{children:"来源"}),e.jsx("th",{children:"数值"})]})}),e.jsxs("tbody",{children:[c.map(([n,f,j],p)=>e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:`${r}${n}-${p}`,children:n})}),e.jsx("td",{children:f}),e.jsxs("td",{children:[e.jsx("input",{id:`${r}${n}-${p}`,defaultValue:j,onChange:x=>{try{const C=i(x.target.value),b=[...c];b[p][2]=C,d(b)}catch(C){x.target.setCustomValidity(C.message)}}}),n.startsWith("固定")?null:"%"]}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>{const x=[...c];x.splice(p,1),d(x)},children:"×"})})]},`${r}-${n}-${f}`)),m&&e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("select",{ref:y,children:U.map(n=>e.jsx("option",{value:n,children:n},n))})}),e.jsx("td",{children:e.jsx("input",{"aria-label":"Buff source",ref:o,defaultValue:""})}),e.jsx("td",{children:e.jsx("input",{"aria-label":"Buff value",ref:v,defaultValue:"0"})}),e.jsxs("td",{children:[e.jsx("button",{type:"button",onClick:()=>{let n=0;try{n=i(v.current.value)}catch(j){v.current.setCustomValidity(j.message);return}if(c.some(j=>j[0]===y.current.value&&j[1]===o.current.value)){o.current.setCustomValidity("已经有相同属性和来源的增益");return}const f=[y.current.value,o.current.value,n];d([...c,f]),u(!1)},children:"√"}),e.jsx("button",{type:"button",onClick:()=>{u(!1)},children:"×"})]})]})]})]}),e.jsx("button",{type:"button",className:g.addBuffBtn,onClick:()=>u(!0),children:"+"})]})}function ke(){const[r,c]=a.useState(80),[d,m]=a.useState(D.冰),[u,y]=a.useState(1271),[o,v]=a.useState(2600),[n,f]=a.useState(882),[j,p]=a.useState(0),[x,C]=a.useState(245),[b,X]=a.useState(0),[_,Y]=a.useState(0),[F,Z]=a.useState(0),[q,ee]=a.useState(0),[E,te]=a.useState(95),[O,se]=a.useState(0),[w,le]=a.useState(0),[V,ae]=a.useState("未击破"),[h,B]=a.useState(ye),{百分比攻击:R,百分比生命:$,百分比防御:N,固定攻击:T,固定生命:L,固定防御:M,增伤:A,暴击伤害:K,击破特攻:H,击破增伤:I,易伤:W,减防:z,减抗:G,真伤:J,独立乘区:P}=ve(h),Q=u*(1+R/100)+T,re=o*(1+$/100)+L,ne=n*(1+N/100)+M,ce=((j/100*Q+x/100*re+b/100*ne)*(1+K/100)+q/100*Q)*(1+A/100),ie=V==="击破"?d/100*3767.55*(w/40+.5):0,de=V==="未击破"?0:F/100*3767.55*_/10,he=(ie+de)*(1+H/100)*(1+I/100),ue=(r+20)/(r+20+(E+20)*(1-Math.min(z/100,1))),je=Math.max(-100,Math.min(O-G,90)),xe=(ce+he)*(1+W/100)*ue*(1-je/100)*(1+J/100)*(1+P/100);return e.jsxs("div",{children:[e.jsx("h1",{children:"星铁伤害计算器"}),e.jsx("p",{children:"一些参考："}),e.jsxs("ul",{children:[e.jsx("li",{children:"主词条：43.2%生命/43.2%攻击/54.0%防御/38.4%增伤/64.8%暴伤/64.8%击破特攻"}),e.jsxs("li",{children:["角色基础面板/技能组：",e.jsx("a",{href:"https://homdgcat.wiki/sr/char",rel:"noopener noreferrer",target:"_blank",children:"玉衡杯"})]}),e.jsx("li",{children:"敌人抗性有弱点为 0，无弱点默认 20%，额外抗性另标"})]}),e.jsx("p",{children:e.jsx("strong",{children:"注："})}),e.jsxs("ul",{children:[e.jsx("li",{children:"假设满暴击率"}),e.jsx("li",{children:"目前考虑不了角色打多种属性伤害，比如停云赐福雷属性附加伤害、海瑟音多颜色DOT等，这些会影响倍率区、增伤区、抗性区的计算"}),e.jsx("li",{children:"目前考虑不了特定伤害类型乘区，比如系囚套DOT减防、繁星套战技增伤等"}),e.jsx("li",{children:"基于以上两点，建议一次算一种属性一种伤害类型，然后再把多个伤害来源相加"}),e.jsx("li",{children:"光锥、星魂因为涉及机制和基础面板，不属于可调整的配置，如需调整需要手动计算。光锥和星魂效果属于自拐"}),e.jsx("li",{children:"非完全覆盖的buff（如大公套、辅助buff、需要叠层的自拐等）请自行评估覆盖率"}),e.jsx("li",{children:"倍率拐（如同谐主）和附伤（如缇宝）无法统计，倍率请填在角色基础倍率中，附伤请单独计算"}),e.jsxs("li",{children:["下面的输入框支持基本数学表达式，如",e.jsx("code",{children:"44*5"})]})]}),e.jsx("h2",{children:"敌人基础数值"}),e.jsxs("table",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"敌人等级",children:"等级"})}),e.jsx("td",{children:e.jsx("input",{id:"敌人等级",defaultValue:E,onChange:t=>{try{te(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"敌人抗性",children:"抗性"})}),e.jsxs("td",{children:[e.jsx("input",{id:"敌人抗性",defaultValue:O,onChange:t=>{try{se(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}}),"%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"韧性上限",children:"韧性上限"})}),e.jsx("td",{children:e.jsx("input",{id:"韧性上限",defaultValue:w,onChange:t=>{try{le(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"韧性状态",children:"韧性状态"})}),e.jsx("td",{children:e.jsxs("select",{id:"韧性状态",defaultValue:V,onChange:t=>{ae(t.target.selectedOptions[0].value)},children:[e.jsx("option",{children:"未击破"}),e.jsx("option",{children:"击破"}),e.jsx("option",{children:"已击破"})]})})]})]}),e.jsx("h2",{children:"角色基础数值"}),e.jsxs("table",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"等级",children:"等级"})}),e.jsx("td",{children:e.jsx("input",{id:"等级",defaultValue:r,onChange:t=>{try{c(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"属性",children:"属性"})}),e.jsx("td",{children:e.jsx("select",{id:"属性",defaultValue:"冰",onChange:t=>{m(D[t.target.selectedOptions[0].value])},children:Object.keys(D).map(t=>e.jsx("option",{value:t,children:t},t))})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"基础攻击",children:"基础攻击"})}),e.jsx("td",{children:e.jsx("input",{id:"基础攻击",defaultValue:u,onChange:t=>{try{y(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"直伤攻击倍率",children:"直伤攻击倍率"})}),e.jsxs("td",{children:[e.jsx("input",{id:"直伤攻击倍率",defaultValue:j,onChange:t=>{try{p(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}}),"%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"基础生命",children:"基础生命"})}),e.jsx("td",{children:e.jsx("input",{id:"基础生命",defaultValue:o,onChange:t=>{try{v(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"直伤生命倍率",children:"直伤生命倍率"})}),e.jsxs("td",{children:[e.jsx("input",{id:"直伤生命倍率",defaultValue:x,onChange:t=>{try{C(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}}),"%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"基础防御",children:"基础防御"})}),e.jsx("td",{children:e.jsx("input",{id:"基础防御",defaultValue:n,onChange:t=>{try{f(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"直伤防御倍率",children:"直伤防御倍率"})}),e.jsxs("td",{children:[e.jsx("input",{id:"直伤防御倍率",defaultValue:b,onChange:t=>{try{X(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}}),"%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"实际削韧值",children:"实际削韧值"})}),e.jsx("td",{children:e.jsx("input",{id:"实际削韧值",defaultValue:_,onChange:t=>{try{Y(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})}),e.jsx("th",{children:e.jsx("label",{htmlFor:"超击破倍率",children:"超击破倍率"})}),e.jsxs("td",{children:[e.jsx("input",{id:"超击破倍率",defaultValue:F,onChange:t=>{try{Z(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}}),"%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{htmlFor:"DOT倍率",children:"DOT倍率"})}),e.jsx("td",{children:e.jsx("input",{id:"DOT倍率",defaultValue:q,onChange:t=>{try{ee(i(t.target.value))}catch(l){t.target.setCustomValidity(l.message)}}})})]})]}),e.jsx("h2",{children:"角色自拐"}),e.jsx(k,{id:"角色",buffs:h.角色,setBuffs:t=>B({...h,角色:t})}),e.jsx("h2",{children:"角色遗器方案"}),e.jsx(k,{id:"遗器",buffs:h.遗器,setBuffs:t=>B({...h,遗器:t})}),e.jsx("h2",{children:"辅助1"}),e.jsx(k,{id:"辅助1",buffs:h.辅助1,setBuffs:t=>B({...h,辅助1:t})}),e.jsx("h2",{children:"辅助2"}),e.jsx(k,{id:"辅助2",buffs:h.辅助2,setBuffs:t=>B({...h,辅助2:t})}),e.jsx("h2",{children:"辅助3"}),e.jsx(k,{id:"辅助3",buffs:h.辅助3,setBuffs:t=>B({...h,辅助3:t})}),e.jsx("h2",{children:"最终伤害"}),e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsxs("div",{className:g.equationLine,children:[e.jsxs(S,{children:[e.jsxs("div",{className:g.equationLine,children:[e.jsxs(S,{children:[e.jsxs("p",{children:[e.jsx(s,{stat:j,label:"攻击倍率",percentage:!0})," × (",e.jsx(s,{stat:u,label:"基础攻击"})," × (1 + ",e.jsx(s,{stat:R,label:"百分比攻击",percentage:!0}),") + ",e.jsx(s,{stat:T,label:"固定攻击"}),")"]}),e.jsxs("p",{children:[e.jsx(s,{stat:x,label:"生命倍率",percentage:!0})," × (",e.jsx(s,{stat:o,label:"基础生命"})," × (1 + ",e.jsx(s,{stat:$,label:"百分比生命",percentage:!0}),") + ",e.jsx(s,{stat:L,label:"固定生命"}),")"]}),e.jsxs("p",{children:[e.jsx(s,{stat:b,label:"防御倍率",percentage:!0})," × (",e.jsx(s,{stat:n,label:"基础防御"})," × (1 + ",e.jsx(s,{stat:N,label:"百分比防御",percentage:!0}),") + ",e.jsx(s,{stat:M,label:"固定防御"}),")"]})]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:K,label:"暴击伤害",percentage:!0}),")"]})]}),e.jsxs("p",{children:[e.jsx(s,{stat:q,label:"DOT倍率",percentage:!0})," × (",e.jsx(s,{stat:u,label:"基础攻击"})," × (1 + ",e.jsx(s,{stat:R,label:"百分比攻击",percentage:!0}),") + ",e.jsx(s,{stat:T,label:"固定攻击"}),")"]})]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:A,label:"增伤",percentage:!0}),")"]})]}),V!=="未击破"&&e.jsxs("div",{className:g.equationLine,children:[e.jsxs(S,{children:[V==="击破"&&e.jsxs("p",{children:[e.jsx(s,{stat:d,label:"属性击破倍率",percentage:!0})," ","× 3767.55 × (",e.jsx(s,{stat:w,label:"韧性上限"})," / 40 + 0.5)"]}),e.jsxs("p",{children:[e.jsx(s,{stat:F,label:"超击破倍率",percentage:!0})," × 3767.55 × ",e.jsx(s,{stat:_,label:"实际削韧值"})," / 10"]})]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:H,label:"击破特攻",percentage:!0}),") × (1 + ",e.jsx(s,{stat:I,label:"击破增伤",percentage:!0}),")"]})]})]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:W,label:"易伤",percentage:!0}),")"]}),e.jsxs("p",{children:["× (",e.jsx(s,{stat:r,label:"角色等级"})," + 20) / (",e.jsx(s,{stat:r,label:"角色等级"})," + 20 + (",e.jsx(s,{stat:E,label:"敌人等级"})," + 20) × (1 － min(",e.jsx(s,{stat:z,label:"减防",percentage:!0}),", 100%)))"]}),e.jsxs("p",{children:["× (1 － clamp(－100%, ",e.jsx(s,{stat:O,label:"敌人抗性",percentage:!0})," － ",e.jsx(s,{stat:G,label:"减抗",percentage:!0}),", 90%))"]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:J,label:" 真伤",percentage:!0}),")"]}),e.jsxs("p",{children:["× (1 + ",e.jsx(s,{stat:P,label:"独立乘区",percentage:!0}),")"]})]}),e.jsxs("output",{children:["= ",e.jsx("strong",{children:Math.round(xe)})]})]})}const Se={title:"Star Rail damage calculator",description:"Estimate the damage with any given team & buffs in Honkai: Star Rail"};export{ke as default,Se as meta};
