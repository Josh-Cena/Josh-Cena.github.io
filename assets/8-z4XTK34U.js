import{u as i,j as s}from"./index-DMPu5IjH.js";import{P as m,a as c}from"./_components-Cf-Fn7vF.js";const l={tags:["Memoization"],description:"Advent of Code 2022 - Day 8: Treetop Tree House, a problem that involves Memoization. Solution written in Haskell, with detailed walkthrough and proof.",year:2022,day:8,title:"Advent of Code 2022 - Day 8: Treetop Tree House"};function n(a){const e={annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mstyle:"mstyle",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",munder:"munder",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",svg:"svg",...i(),...a.components};return s.jsxs(s.Fragment,{children:[s.jsxs(e.h1,{children:["Advent of Code 2022 - Day 8",s.jsx(e.span,{className:"subtitle",children:"Treetop Tree House"})]}),`
`,`
`,s.jsx(m,{frontMatter:l}),`
`,s.jsx(e.h2,{children:"Part 1"}),`
`,s.jsxs(e.p,{children:["If the grid's side length is ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsx(e.mi,{children:"n"})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"n"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.4306em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"n"})]})})]}),", then there are ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mn,{children:"4"}),s.jsx(e.mi,{children:"n"})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"4n"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.6444em"}}),s.jsx(e.span,{className:"mord",children:"4"}),s.jsx(e.span,{className:"mord mathnormal",children:"n"})]})})]})," directions to check for visibility. We scan along each direction and count visible trees. To determine the visibility, we need to check all trees before it and see if they are all shorter than the current one—i.e., compare the maximum height of the trees before it. The maximum can be tracked as we scan, so there's no need to scan backwards again."]}),`
`,s.jsx(e.span,{className:"katex-display",children:s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mtable,{rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em",children:[s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"p"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"v"}),s.jsx(e.mi,{children:"M"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsx(e.mrow,{}),s.jsx(e.mo,{children:"="}),s.jsxs(e.mrow,{children:[s.jsx(e.mo,{fence:"true",children:"{"}),s.jsxs(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mtext,{children:"if "}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"="}),s.jsx(e.mn,{children:"0"})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"max"}),s.jsx(e.mo,{children:"⁡"}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"p"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"v"}),s.jsx(e.mi,{children:"M"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"g"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"d"})]}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsx(e.mtext,{children:"otherwise"})})})]})]})]})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"v"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"b"}),s.jsx(e.mi,{children:"l"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"F"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"o"}),s.jsx(e.mi,{children:"m"}),s.jsx(e.mi,{children:"L"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"f"}),s.jsx(e.mi,{children:"t"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsx(e.mrow,{}),s.jsx(e.mo,{children:"="}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"g"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"d"})]}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{children:">"}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"p"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"v"}),s.jsx(e.mi,{children:"M"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})})]})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:`\\begin{aligned}
\\mathit{prevMax}(i, j) &= \\begin{cases}-1&\\text{if } j = 0\\\\\\max(\\mathit{prevMax}(i, j - 1), \\mathit{grid}[i][j-1])&\\text{otherwise}\\end{cases}\\\\
\\mathit{visibleFromLeft}(i, j) &= \\mathit{grid}[i][j] > \\mathit{prevMax}(i, j)
\\end{aligned}`})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"4.8em",verticalAlign:"-2.15em"}}),s.jsx(e.span,{className:"mord",children:s.jsxs(e.span,{className:"mtable",children:[s.jsx(e.span,{className:"col-align-r",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"2.65em"},children:[s.jsxs(e.span,{style:{top:"-4.65em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.75em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"prevMax"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose",children:")"})]})]}),s.jsxs(e.span,{style:{top:"-2.26em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.75em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"visibleFromLeft"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose",children:")"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"2.15em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"2.65em"},children:[s.jsxs(e.span,{style:{top:"-4.65em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.75em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsxs(e.span,{className:"minner",children:[s.jsx(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:s.jsx(e.span,{className:"delimsizing size4",children:"{"})}),s.jsx(e.span,{className:"mord",children:s.jsxs(e.span,{className:"mtable",children:[s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"1.69em"},children:[s.jsxs(e.span,{style:{top:"-3.69em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:"−"}),s.jsx(e.span,{className:"mord",children:"1"})]})]}),s.jsxs(e.span,{style:{top:"-2.25em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mop",children:"max"}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"prevMax"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:"1"}),s.jsx(e.span,{className:"mclose",children:")"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"grid"})}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mclose",children:"]"}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:"1"}),s.jsx(e.span,{className:"mclose",children:"])"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.19em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"arraycolsep",style:{width:"1em"}}),s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"1.69em"},children:[s.jsxs(e.span,{style:{top:"-3.69em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"if "})}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord",children:"0"})]})]}),s.jsxs(e.span,{style:{top:"-2.25em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"otherwise"})})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.19em"},children:s.jsx(e.span,{})})})]})})]})}),s.jsx(e.span,{className:"mclose nulldelimiter"})]})]})]}),s.jsxs(e.span,{style:{top:"-2.26em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.75em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"grid"})}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mclose",children:"]"}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose",children:"]"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:">"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"prevMax"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose",children:")"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"2.15em"},children:s.jsx(e.span,{})})})]})})]})})]})})]})}),`
`,s.jsxs(e.p,{children:["So ",s.jsx(e.code,{children:"prevMax"})," is an accumulator and we store ",s.jsx(e.code,{children:"visibleFromLeft"})," for each tree. These two can be done at the same time with ",s.jsx(e.code,{children:"mapAccumL"})," and ",s.jsx(e.code,{children:"mapAccumR"}),"."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-hs",children:`scanner :: Int -> Int -> (Int, Bool)
scanner prevMax height = (max prevMax height, height > prevMax)

leftVisible :: [Int] -> [Bool]
leftVisible = snd . mapAccumL scanner (-1)

rightVisible :: [Int] -> [Bool]
rightVisible = snd . mapAccumR scanner (-1)
`})}),`
`,s.jsxs(e.p,{children:["I apply this to each row and column (by transposing the grid) and use ",s.jsx(e.code,{children:"zipWith"})," to combine each cell with ",s.jsx(e.code,{children:"||"}),". Finally I can count the number of ",s.jsx(e.code,{children:"True"})," values."]}),`
`,s.jsx(e.h2,{children:"Part 2"}),`
`,s.jsxs(e.p,{children:["This time, we are not ",s.jsx(e.em,{children:"counting"})," visible trees, just finding the distance to the first tree that is taller or equal in height. This can be done with a similar approach, but instead of tracking the maximum height, we track the distance to the last tree of each height."]}),`
`,s.jsx(e.span,{className:"katex-display",children:s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:s.jsxs(e.semantics,{children:[s.jsxs(e.mtable,{rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em",children:[s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"l"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mi,{children:"t"}),s.jsx(e.mi,{children:"I"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mi,{children:"d"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"h"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsx(e.mrow,{}),s.jsx(e.mo,{children:"="}),s.jsxs(e.mrow,{children:[s.jsx(e.mo,{fence:"true",children:"{"}),s.jsxs(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsx(e.mn,{children:"0"})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mtext,{children:"if "}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"="}),s.jsx(e.mn,{children:"0"})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsx(e.mtext,{children:"if "}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"g"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"d"})]}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{children:"="}),s.jsx(e.mi,{children:"h"})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"l"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mi,{children:"t"}),s.jsx(e.mi,{children:"I"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mi,{children:"d"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsx(e.mn,{children:"1"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"h"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:s.jsx(e.mtext,{children:"otherwise"})})})]})]})]})]})})})]}),s.jsxs(e.mtr,{children:[s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"d"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mi,{children:"t"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mi,{children:"c"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"T"}),s.jsx(e.mi,{children:"o"}),s.jsx(e.mi,{children:"L"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"f"}),s.jsx(e.mi,{children:"t"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})}),s.jsx(e.mtd,{children:s.jsx(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:s.jsxs(e.mrow,{children:[s.jsx(e.mrow,{}),s.jsx(e.mo,{children:"="}),s.jsxs(e.munder,{children:[s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"min"}),s.jsx(e.mo,{children:"⁡"})]}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"h"}),s.jsx(e.mo,{children:"≥"}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"g"}),s.jsx(e.mi,{children:"r"}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mi,{children:"d"})]}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{stretchy:"false",children:"]"}),s.jsx(e.mo,{stretchy:"false",children:"["}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{stretchy:"false",children:"]"})]})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{children:"−"}),s.jsxs(e.mrow,{children:[s.jsx(e.mi,{children:"l"}),s.jsx(e.mi,{children:"a"}),s.jsx(e.mi,{children:"s"}),s.jsx(e.mi,{children:"t"}),s.jsx(e.mi,{children:"I"}),s.jsx(e.mi,{children:"n"}),s.jsx(e.mi,{children:"d"}),s.jsx(e.mi,{children:"e"}),s.jsx(e.mi,{children:"x"})]}),s.jsx(e.mo,{stretchy:"false",children:"("}),s.jsx(e.mi,{children:"i"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"j"}),s.jsx(e.mo,{separator:"true",children:","}),s.jsx(e.mi,{children:"h"}),s.jsx(e.mo,{stretchy:"false",children:")"}),s.jsx(e.mo,{stretchy:"false",children:")"})]})})})]})]}),s.jsx(e.annotation,{encoding:"application/x-tex",children:`\\begin{aligned}
\\mathit{lastIndex}(i, j, h) &= \\begin{cases}0&\\text{if } j = 0\\\\j - 1&\\text{if } \\mathit{grid}[i][j-1] = h\\\\\\mathit{lastIndex}(i, j - 1, h)&\\text{otherwise}\\end{cases}\\\\
\\mathit{distanceToLeft}(i, j) &= \\min_{h \\geq \\mathit{grid}[i][j]} (j - \\mathit{lastIndex}(i, j, h))
\\end{aligned}`})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"6.726em",verticalAlign:"-3.113em"}}),s.jsx(e.span,{className:"mord",children:s.jsxs(e.span,{className:"mtable",children:[s.jsx(e.span,{className:"col-align-r",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"3.613em"},children:[s.jsxs(e.span,{style:{top:"-5.613em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"4.41em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"lastIndex"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"h"}),s.jsx(e.span,{className:"mclose",children:")"})]})]}),s.jsxs(e.span,{style:{top:"-2.563em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"4.41em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"distanceToLeft"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose",children:")"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"3.113em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"3.613em"},children:[s.jsxs(e.span,{style:{top:"-5.613em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"4.41em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsxs(e.span,{className:"minner",children:[s.jsx(e.span,{className:"mopen",children:s.jsx(e.span,{className:"delimsizing mult",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"2.35em"},children:[s.jsxs(e.span,{style:{top:"-2.2em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.15em"}}),s.jsx(e.span,{className:"delimsizinginner delim-size4",children:s.jsx(e.span,{children:"⎩"})})]}),s.jsxs(e.span,{style:{top:"-2.192em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.15em"}}),s.jsx(e.span,{style:{height:"0.316em",width:"0.8889em"},children:s.jsx(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.8889em",height:"0.316em",style:{width:"0.8889em"},viewBox:"0 0 888.89 316",preserveAspectRatio:"xMinYMin",children:s.jsx(e.path,{d:"M384 0 H504 V316 H384z M384 0 H504 V316 H384z"})})})]}),s.jsxs(e.span,{style:{top:"-3.15em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.15em"}}),s.jsx(e.span,{className:"delimsizinginner delim-size4",children:s.jsx(e.span,{children:"⎨"})})]}),s.jsxs(e.span,{style:{top:"-4.292em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.15em"}}),s.jsx(e.span,{style:{height:"0.316em",width:"0.8889em"},children:s.jsx(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.8889em",height:"0.316em",style:{width:"0.8889em"},viewBox:"0 0 888.89 316",preserveAspectRatio:"xMinYMin",children:s.jsx(e.path,{d:"M384 0 H504 V316 H384z M384 0 H504 V316 H384z"})})})]}),s.jsxs(e.span,{style:{top:"-4.6em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.15em"}}),s.jsx(e.span,{className:"delimsizinginner delim-size4",children:s.jsx(e.span,{children:"⎧"})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.85em"},children:s.jsx(e.span,{})})})]})})}),s.jsx(e.span,{className:"mord",children:s.jsxs(e.span,{className:"mtable",children:[s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"2.41em"},children:[s.jsxs(e.span,{style:{top:"-4.41em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord",children:"0"})})]}),s.jsxs(e.span,{style:{top:"-2.97em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:"1"})]})]}),s.jsxs(e.span,{style:{top:"-1.53em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"lastIndex"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:"1"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"h"}),s.jsx(e.span,{className:"mclose",children:")"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.91em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"arraycolsep",style:{width:"1em"}}),s.jsx(e.span,{className:"col-align-l",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"2.41em"},children:[s.jsxs(e.span,{style:{top:"-4.41em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"if "})}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord",children:"0"})]})]}),s.jsxs(e.span,{style:{top:"-2.97em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"if "})}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"grid"})}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mclose",children:"]"}),s.jsx(e.span,{className:"mopen",children:"["}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:"1"}),s.jsx(e.span,{className:"mclose",children:"]"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"h"})]})]}),s.jsxs(e.span,{style:{top:"-1.53em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3.008em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord text",children:s.jsx(e.span,{className:"mord",children:"otherwise"})})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"1.91em"},children:s.jsx(e.span,{})})})]})})]})}),s.jsx(e.span,{className:"mclose nulldelimiter"})]})]})]}),s.jsxs(e.span,{style:{top:"-2.563em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"4.41em"}}),s.jsxs(e.span,{className:"mord",children:[s.jsx(e.span,{className:"mord"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mrel",children:"="}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),s.jsx(e.span,{className:"mop op-limits",children:s.jsxs(e.span,{className:"vlist-t vlist-t2",children:[s.jsxs(e.span,{className:"vlist-r",children:[s.jsxs(e.span,{className:"vlist",style:{height:"0.6679em"},children:[s.jsxs(e.span,{style:{top:"-2.309em",marginLeft:"0em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3em"}}),s.jsx(e.span,{className:"sizing reset-size6 size3 mtight",children:s.jsxs(e.span,{className:"mord mtight",children:[s.jsx(e.span,{className:"mord mathnormal mtight",children:"h"}),s.jsx(e.span,{className:"mrel mtight",children:"≥"}),s.jsx(e.span,{className:"mord mtight",children:s.jsx(e.span,{className:"mord mathit mtight",children:"grid"})}),s.jsx(e.span,{className:"mopen mtight",children:"["}),s.jsx(e.span,{className:"mord mathnormal mtight",children:"i"}),s.jsx(e.span,{className:"mclose mtight",children:"]"}),s.jsx(e.span,{className:"mopen mtight",children:"["}),s.jsx(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mclose mtight",children:"]"})]})})]}),s.jsxs(e.span,{style:{top:"-3em"},children:[s.jsx(e.span,{className:"pstrut",style:{height:"3em"}}),s.jsx(e.span,{children:s.jsx(e.span,{className:"mop",children:"min"})})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"0.966em"},children:s.jsx(e.span,{})})})]})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mbin",children:"−"}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),s.jsx(e.span,{className:"mord",children:s.jsx(e.span,{className:"mord mathit",children:"lastIndex"})}),s.jsx(e.span,{className:"mopen",children:"("}),s.jsx(e.span,{className:"mord mathnormal",children:"i"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",style:{marginRight:"0.05724em"},children:"j"}),s.jsx(e.span,{className:"mpunct",children:","}),s.jsx(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"h"}),s.jsx(e.span,{className:"mclose",children:"))"})]})]})]}),s.jsx(e.span,{className:"vlist-s",children:"​"})]}),s.jsx(e.span,{className:"vlist-r",children:s.jsx(e.span,{className:"vlist",style:{height:"3.113em"},children:s.jsx(e.span,{})})})]})})]})})]})})]})}),`
`,s.jsxs(e.p,{children:["We can still treat ",s.jsx(e.code,{children:"lastIndex"})," as an accumulator, but instead of a single value, we now need to memorize one value per ",s.jsxs(e.span,{className:"katex",children:[s.jsx(e.span,{className:"katex-mathml",children:s.jsx(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:s.jsxs(e.semantics,{children:[s.jsx(e.mrow,{children:s.jsx(e.mi,{children:"h"})}),s.jsx(e.annotation,{encoding:"application/x-tex",children:"h"})]})})}),s.jsx(e.span,{className:"katex-html","aria-hidden":"true",children:s.jsxs(e.span,{className:"base",children:[s.jsx(e.span,{className:"strut",style:{height:"0.6944em"}}),s.jsx(e.span,{className:"mord mathnormal",children:"h"})]})})]}),". I use ",s.jsx(e.code,{children:"Data.IntMap"})," for this."]}),`
`,s.jsx(e.pre,{children:s.jsx(e.code,{className:"language-hs",children:`scanner2 :: IntMap Int -> (Int, Int) -> (IntMap Int, Int)
scanner2 lastIndex (j, height) = (lastIndex', minimum distances)
  where
    distances = [j - fromMaybe 0 (IntMap.lookup h lastIndex) | h <- [height .. 9]]
    lastIndex' = IntMap.insert height j lastIndex

leftDistances :: [Int] -> [Int]
leftDistances = snd . mapAccumL scanner2 IntMap.empty . zip [0 ..]

rightDistances :: [Int] -> [Int]
rightDistances xs = snd $ mapAccumR scanner2 IntMap.empty $ zip [(length xs - 1), (length xs - 2) .. 0] xs
`})}),`
`,s.jsxs(e.p,{children:["Again, we apply these two functions to each row and column and combine the results with ",s.jsx(e.code,{children:"zipWith"})," (this time multiplying them). Finally I can find the maximum value."]}),`
`,s.jsx(c,{frontMatter:l})]})}function h(a={}){const{wrapper:e}={...i(),...a.components};return e?s.jsx(e,{...a,children:s.jsx(n,{...a})}):n(a)}export{h as default,l as frontMatter};
